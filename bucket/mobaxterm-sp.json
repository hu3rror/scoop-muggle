{
    "version": "25.2",
    "description": "Enhanced terminal for Windows with X11 server, tabbed SSH client, network tools and much more.",
    "homepage": "https://mobaxterm.mobatek.net/",
    "license": {
        "identifier": "Freeware",
        "url": "https://mobaxterm.mobatek.net/license.html"
    },
    "url": "https://download.mobatek.net/2522025040602403/MobaXterm_Portable_v25.2.zip",
    "hash": "b279fe9ec9b22200288778cc4a4a14aca66e64824cd73ac1bb94a71e38d64ef3",
    "pre_install": [
        "    # Rename executable",
        "Get-ChildItem \"$dir\" 'mobaxterm*.exe' | Select-Object -First 1 | Rename-Item -NewName 'MobaXterm.exe'",
        "    # Create files for persisting",
        "function PersistsFile([String] $file) {",
        "    if (!(Test-Path \"$persist_dir\\$file\")) {",
        "        New-Item \"$dir\\$file\" -Type File | Out-Null",
        "    }",
        "}",
        "@('MobaXterm backup.zip', 'MobaXterm.ini') | ForEach-Object { PersistsFile $_ }"
    ],
    "pre_uninstall": [
        "function UpdatesFile([string] $file) {",
        "    if ((Get-ChildItem \"$dir\\$file\").LastWriteTime -gt (Get-ChildItem \"$persist_dir\\$file\").LastWriteTime) {",
        "        [System.IO.File]::WriteAllBytes(\"$persist_dir\\$file\", [System.IO.File]::ReadAllBytes(\"$dir\\$file\"))",
        "    }",
        "}",
        "@('MobaXterm backup.zip', 'MobaXterm.ini') | ForEach-Object { UpdatesFile $_ }"
    ],
    "bin": "MobaXterm.exe",
    "shortcuts": [
        [
            "MobaXterm.exe",
            "MobaXterm"
        ]
    ],
    "persist": [
        "MobaXterm.ini",
        "MobaXterm backup.zip"
    ],
    "checkver": {
        "url": "https://mobaxterm.mobatek.net/download-home-edition.html",
        "regex": "//download.mobatek.net/(?<random>[\\d]+)/MobaXterm_Portable_v([\\d.]+)\\.zip"
    },
    "autoupdate": {
        "url": "https://download.mobatek.net/$matchRandom/MobaXterm_Portable_v$version.zip"
    },
    "post_install": [
        "if (Get-Command python -ErrorAction SilentlyContinue) {",
        "   Write-Host 'Python is installed. Running MobaXterm-Keygen.py...' -ForegroundColor Green",
        "   $bucketDir = Find-BucketDirectory -Root -Name $bucket",
        "   if ($bucketDir) {",
        "       $scriptPath = Join-Path \"$bucketDir\\scripts\" 'MobaXterm-Keygen.py'",
        "       if (Test-Path $scriptPath) {",
        "           $username = $env:USERNAME",
        "           $tempDir = [System.IO.Path]::GetTempPath()",
        "           $currentDir = Get-Location",
        "           Set-Location -Path $tempDir",
        "           python \"$scriptPath\" \"$username\" \"$version\"",
        "           $licenseFile = Join-Path $tempDir 'Custom.mxtpro'",
        "           if (Test-Path $licenseFile) {",
        "               Copy-Item -Path $licenseFile -Destination \"$dir\" -Force",
        "               Write-Host \"License file successfully generated and copied to installation directory.\" -ForegroundColor Green",
        "               Remove-Item -Path $licenseFile -Force",
        "           } else {",
        "               Write-Host \"Error: License file generation failed.\" -ForegroundColor Red",
        "           }",
        "           Set-Location -Path $currentDir",
        "       } else {",
        "           Write-Host \"Error: MobaXterm-Keygen.py not found in scripts folder.\" -ForegroundColor Red",
        "       }",
        "   } else {",
        "       Write-Host \"Error: Could not find bucket directory.\" -ForegroundColor Red",
        "   }",
        "} else {",
        "   Write-Host 'Python is not installed. Please install Python to run MobaXterm-Keygen.py.' -ForegroundColor Yellow",
        "}"
    ]
}
